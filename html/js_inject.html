
<style>
    .diff-row { background-color: #ffe6e6 !important; }
    .diff-cell { color: #d90000; font-weight: bold; background-color: #ffcccc; }
    .control-panel {
        position: fixed;
        top: 20px;
        right: 20px;
        background: rgba(255, 255, 255, 0.95);
        padding: 15px;
        border: 2px solid #333;
        border-radius: 8px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        z-index: 9999;
        font-family: sans-serif;
        font-size: 16px;
    }
    .control-panel label {
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    .control-panel input[type="checkbox"] {
        transform: scale(1.5);
    }
    /* 正誤（比較対象）が隣り合うように調整 */
    /* 現状のテーブル構造が不明確だが、もし横並びでないならCSSで調整が必要かもしれないが */
    /* Readの結果を見る限り、同じ行のtdとして並んでいるので、すでに隣り合っているはず。 */
</style>
<script>
(function() {
    // コントロールパネル追加
    const panel = document.createElement('div');
    panel.className = 'control-panel';
    panel.innerHTML = `
        <label>
            <input type="checkbox" id="diff-toggle">
            <strong>Show Diff Only (差異のみ表示)</strong>
        </label>
    `;
    document.body.insertBefore(panel, document.body.firstChild);

    // テーブル行の解析とハイライト
    const rows = document.querySelectorAll('table tr');
    rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        // 4番目と5番目のセルを比較（インデックス3と4）
        if (cells.length >= 5) {
            const cellA = cells[3];
            const cellB = cells[4];
            
            // 空白の違いを無視して比較
            const textA = cellA.textContent.replace(/\s+/g, '');
            const textB = cellB.textContent.replace(/\s+/g, '');

            if (textA !== textB) {
                row.classList.add('diff-row');
                cellA.classList.add('diff-cell');
                cellB.classList.add('diff-cell');
            } else {
                row.classList.add('match-row');
            }
        }
    });

    // トグルイベント
    document.getElementById('diff-toggle').addEventListener('change', function(e) {
        const matchRows = document.querySelectorAll('.match-row');
        matchRows.forEach(row => {
            row.style.display = e.target.checked ? 'none' : '';
        });
    });
})();
</script>
