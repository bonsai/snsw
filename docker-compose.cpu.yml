services:
  snsw-ai:
    build: .
    container_name: snsw-ai-container
    volumes:
      # ソースコードのマウント
      - .:/app
      # モデルデータを C:\models に集約（複数回実行で再利用）
      - C:\models:/app/models
      # キャッシュディレクトリ（Hugging Face, PyTorch, Coqui TTS等）
      - C:\models\.cache:/root/.cache
      - C:\models\.local:/root/.local
      # 出力ディレクトリ
      - ./tts_outputs:/app/tts_outputs
      - ./data:/app/data
      - ./dev:/app/dev
    environment:
      - KAGGLE_ENVIRONMENT=0
      # モデルキャッシュの場所を明示的に指定
      - TORCH_HOME=/root/.cache/torch
      - HF_HOME=/root/.cache/huggingface
      - TRANSFORMERS_CACHE=/root/.cache/huggingface/transformers
      - XDG_CACHE_HOME=/root/.cache
      - COQUI_TOS_AGREED=1
    tty: true
    stdin_open: true
