# ADR-008: 評価フィードバックに基づく学習計画の動的調整方針

## 1. ステータス
**提案中 (Proposed)**

## 2. コンテキスト
「五代目古今亭志ん生」の音声再現プロジェクト（出世魚プロジェクト）において、学習（ファインチューニング）の成果をどう評価し、その結果を次の学習にどう反映させるかの指針が必要である。
評価には、物理的な統計情報（RMS、振幅）に加えて、AIによるMOS（自然さ）予測、話者類似度、そして人間（ユーザー）による官能評価が含まれる。

## 3. 意思決定
評価結果に基づき、学習の指針（ハイパーパラメータ、データセット構成、モデル選定）を以下のように動的に変更する。

### **3.1 評価スコアと改善アクションの対応表**

| 評価結果 (FB) | 主な原因の推測 | 学習指針の変更内容 (改善アクション) |
| :--- | :--- | :--- |
| **話者類似度が低い** | データ不足、学習不足 | ・学習エポック数の増加<br>・参照音声（プロンプト）の選定見直し<br>・RVCの追加学習またはマージ比率の調整 |
| **自然さ (MOS) が低い** | 過学習、ノイズの混入 | ・学習率 (Learning Rate) の引き下げ<br>・データセットのクリーニング（笑い声・拍手の徹底除去）<br>・XTTS Baseモデルへの回帰（FTの影響を弱める） |
| **特定の語彙で発音が乱れる** | トランスクリプトの誤り | ・Whisper文字起こしの手動修正<br>・辞書設定（MeCab等）の調整<br>・その語彙を含む音声データの重点追加 |
| **声が若すぎる/老けすぎている** | 参照音源の時期の不一致 | ・データセットを「絶頂期」か「晩年」のいずれかに統一<br>・年代別のタグ付けによる条件付き学習 |

### **3.2 出世魚ランクごとのフィードバックループ**

1.  **WAKASHI (ワカシ - v1):** ゼロショット生成。
    - **指針:** 類似度を最優先。類似度が低い場合は、参照音声をよりクリアなものに変更する。
2.  **INADA (イナダ - v2):** 第一次改善（LoRA/FT開始）。
    - **指針:** 類似度と明瞭度のバランス。不自然なノイズ（アーティファクト）が出る場合は、学習率を下げて再試行。
3.  **WARASA (ワラサ - v3):** 第二次改善（ハイブリッド構成）。
    - **指針:** 表現力（間、抑揚）の追求。RVCを組み合わせて、志ん生特有の「枯れ」を付与。
4.  **BURI (ブリ - Final):** 最終調整。
    - **指針:** 特定演目の最適化。ユーザーが最も重視する演目に合わせた微調整。

## 4. 決定による影響 (Consequences)

### **メリット**
- **無駄な学習の回避:** 評価結果を見てから次の一手を決めるため、計算資源を効率的に使える。
- **再現精度の向上:** 「なんとなく学習する」のではなく、弱点を狙い撃ちで改善できる。
- **透明性:** なぜ学習設定を変えたのかの根拠が、評価レポート ([score-common-audio.py](file:///c:/Users/dance/zone/snsw/src/score-common-audio.py) の出力等) によって明確になる。

### **デメリット/リスク**
- **評価の主観性:** AIスコア (MOS) と人間の感覚が乖離する場合がある。最終判断には必ず人間の試聴が必要。
- **ループの長期化:** 評価と改善を繰り返すことで、完成までの時間が延びる可能性がある。

## 5. 補足
本方針は、[score-common-audio.py](file:///c:/Users/dance/zone/snsw/src/score-common-audio.py) で生成される `audio_analysis_stats.txt` の結果をオーケストレーターが解析し、次の学習スクリプトの引数を自動生成する際のロジックの基礎となる。
